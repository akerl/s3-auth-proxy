sudo: required
dist: trusty
services:
- docker
env:
  global:
  - PATH=$HOME/.local/bin:$PATH
  - PKGFORGE_STATEFILE=/tmp/pkgforge
  - BUCKET=akerl-s3-auth-proxy
  - secure: bpxBa0adsNTbYu9PQeSNNMCo1TBSAuyxyJGKVbIj/WN0PP7yp7weAh0OdTisjCsXuQRINxeC6iyuab+12e7XSeHtw9B0y75swzFKDvkjjKYzgqOg+72Xzw/3Ei4njPBPTpcwe9clBwjYzGLs2twCO/mp17cl4ZeQUcamhN0nBYsOqdP1rcz/s0kmQhQiae55V5wTiWnHnH+XaDVxKQrkZSL5clUmhQI6Epe6so/kNbNFkEw4yz4cQRk57VU4Tj7cQSlcTKdhhl251MSmFPPiN9BlYiXI31KfzGavHTPK7lj9FsJD09mUDI0nPoGSoGIPqrrKFh4h6QXD7VFjcYs/BeMc6ZRmicPOF4Yw844/wrA1KjF6T0NKxNX5ySE5kHE6KMtoLcK5pO0XzLgHmHjImCNuLFQLGcAUczYvr53WoXOHELr5JKGN9mf20lKJX9rDLfBRG7+9L3NVow/VSL+5yN0YNqn1T0nU9w+VlEcJw4VW972cdglqF6iy/sVFZZAokAA/ubhMHq5ShCSowgeGTks+mJr3uSs5zmv+qTd1CVGCmekLlbQKdwHaeUcjuNDogF6w15gleRamCGKLCGwIX1Hn5miqmSlu1QbB28gQxUBdUytP5NFxSKGfcASQtUQm5oe9niNvVJ++vVN7MiMjUImTrYudfDPpcWp3c1m35Ts=
  - secure: Q4zLkPZ9r8VjS4bZZ/1LflX4jhwICkUTtsWq6Q2ZXEOqCBcc8432Z9mc2SOXW12GM6d5RocXAaKUDgFhH+yYlBje+hhcs5fGdbXhwdI2rarCRC91zqD4Sf7Qn80FBoPwpk5k+XoU6OVZbylUvLFDlPyrtSKDcMz9fJ5GSmLo6tCpjxDX0L6A084rzvEWH68M17/mpENB6L+kdXRdhiyAy/lEPpWxz0iiEo8naZujwesMuRJKbTYPlDGv5XPwPfXBUrSQ6NHGreDPvFPN+opaicv4HGWhyrVS/S2ug215BetFh2hZ0a3GsMn+9QW4VKBEmJhybXNkOKA98NKIenqVrfmSn8bc+7TD7SQmzL8/KsP0R21lJDioEIDDPvaXBFu3MMt2XRDBnoeCryQIVv4M2ogKYh738pzGtNjZyagluJHarGeavjliZ9hzvXAW+45Myu9nAMgqfqnvaPBgnpLej+7XUNQOWrIfHCYoqjSULvuKNZjq2RbpfFyIzIhzB/WurbjWv8Z8mUSX5MNKtKvRY7R8cCU7aiodr5MuwZjFweae+1jP8xzn+KtrnI81jMPa7ZbgQQmBA7ViShYIzZc7cX3Ppufi/dGhZFg6LMAg1wCc2kHOiqM/w/6O9OddoRYcHBUZN2WHgJcg+WFDnPxfR9ZFada0HEvX+WG3l7DLK8k=
  - secure: FOKCl9hMEHR2Xw/lv5ghYn3ir82JLc+bQokiSOm+mndwtHWU5leDQU04pc1reC4bLp13TyfzUI6MsbZz/4M5v5CoLxqssbYPrIGi6p3bzbrGGGMEh/l6D1xuT0uLtlopMJ/W5gUU4K57N66Niv7ahhyG8bVluZ/UtffIKvLuoQgjURPYz1Wrzfc6ErlZU00ywCmmKxdWLgXHd9cgfZrjJ1ZauUGavpmiXHu218v9wBKo0MEVaeG9z9FQCQFLqZWJq4dt7RuygqHiEumgIzP6rLYakonSJiQV3H7OTNXN3BWvWV1CffXg1pYTMRqyMXNfCoUW3ENcmvSfgzrAy4VBbCgrmX747ZJ9zzV+e5BibO0oBftMfOdvUWBbwQbqeGYN9CuTgHrrbvHrhlt2CqfkI+sVKVSWYvM+wgMfYGrwThXlHmVWuPHVkYr3pLK0vo1jGgmmiJbFGUOW/7il8VeAKCs9s+gZ1683I1uwnDXls+YduPvBI7h4lhbsLkCPBe0G4qOaYKoGG1NT8UmFjE4pHXER3cqaGbETA4HLve5V+2xMMPFHVBFaNS+zMmUposPEYJ5JjXWO9z3EE+Vihgqo7cewkuJKZGXRKldmN7XsAZZTgX7zO6EXGvJUvv89zgYrEX/yPP767d5Dwo/TJRoOAFnrQJvu2yPSQC/qwLuGPxY=
before_install:
- pip install --user awscli
script: make
deploy:
  provider: script
  script: make release && aws s3 cp pkg/payload.zip "s3://$BUCKET/lambdas/payload-$TRAVIS_TAG.zip"
    || travis_terminate 1
  skip_cleanup: true
  on:
    tags: true
notifications:
  email: false
  slack:
    secure: WYODL/nsmTH8CZuxUVEAS9IDSYko+Biy4epV9gjxMZOJHJp03LJWJ9TIBqyfxmo1D/EtGy5QOw0S996NB51qkhvrszeBnA2lObhb2EWkVtv5To3LYTd9pt0by3tVbiA180k8LV6hNlWpqTLc/OOVH/8ts28SyubeTNzbRjXRzuKvR9f0QLamsNoQSwASgqUwNvH4Jck+MRpRvJX5IWCxBVhe6+P/ah72t1wVXO4sbDl+JhMvg8rzQaphwbbD5a3sTttIKo9AtvPnQDVjjgcKVHfkPCzasJ+9adFycML2Y1tTb+5+UW6n2/eXzU2VXrZ+04P8HBuQZFRrX/3d8q/+WaTHG4zVYSrsw93uF2BlTdKk+1oigdkeYfk+bBFS8rYCd+Tuzb5nQi0cqKbICDznoQ4xVAg6CwJa0NOSrijsTXcj6tooZh2YOytNl0AUI5OfcVJLesV66j1XH1qOgc8xQwfhkIs6OJhcBNSbmF/w1qq82mSUQB/HURNlzTJyOdHS9oeZVNhcjxLR/i0AZPdCJPugQmP1IgDIdGpBXIgbcukeK1NbhLw5aVpiVsX6WEfZVuJe7dhBYWZHR5c1QZZHMOTW76F81ypWsniWHtsdYrm/G9j4qd1UncXfcmGSJL/hX01jTUx92lv2HI3+dxNbCBmqSHE9gGbWNOrlSObECJ8=
