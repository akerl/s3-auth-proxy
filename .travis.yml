sudo: required
dist: trusty
services:
- docker
env:
  global:
  - PATH=$HOME/.local/bin:$PATH
  - PKGFORGE_STATEFILE=/tmp/pkgforge
  - BUCKET=akerl-s3-auth-proxy
  - secure: jU8BU01W20LHi4dmsy/888SeuGe0IkqixJw2q8+6Qy1+0v6T5Xnom19lpcWEtHE8ergi153ue7WCMFvJJLbAvAKH6l/6OL9Z7gGoFC5b336tWev4oOOFemtyrQYo98VtSlXl+RgE53gNkSfY8ValUObHNe881d34uhac76orlIN7CyrkmeGjwjY/SLzB/VBBcim2fE/6ilTlX9KLlWQ7wNDGaZgdsUIWykO+ahi2hY/0deTnc1imlfjzpRGhnUSkgEvkOT164KA6YPcQ+UUoh3vqSjDObgX5sZ8BpyIeyK03FTIjPQ2goSW2EIGgGi70DuSnhvfQV6/IBItovigVLtjL2FjDCAyYsNqBAoFoTsl4yNVjB34vrSUiG5brqaRtBnNkUbR2YEqCn5QYVf/OZQya5RcIbmQtAftQKXxJe5rWB4PuP38tXFaDvXpnFYprVglhtVz9qOljmyHTRpwFjJMoofTBSvALUDhd89KXuJSL5hMLBmkdOm1qNRBWYgmKBEuqB1ZyC4bM8KTxYeWNfC9ilKHw0k9EaBS37bLQql/WxljAs4v/7NKLi+iXFwdwLNflaIp9XvM8a4sUCyQnxOsr9NDpxuXQtIJn1+/u3ZouqsEzkYYXAZ1ZDd4fUw+hpl4TlVyXktprGcWNsbdGMgHsWwspG1pJ0s5BvXmR6Zs=
  - secure: E+cIcwpPsPsGlkFbJT0kooabcCopR0d2GmLJqfM7FDUg7DEtAIG3YrK4RDIlU4pN+Y9tg8USvQpB21+2beEMWDqdQlyY9AvdeIzLE9B+1jw0cL9wL8ODVGajuzVA4IFjmf994qv0pPYfJY7UFEkacFzbz/a0tKG/fF7w1bznv1gDPfLEIir9KqK8QpdCIN3jGipuXjaWOsMkL9dcdDh2KcL1+38noiOggHp56A4Pfp9kWmonJlv0oiuEqh/6tGUy5jkI7a3sNX1hhwGxDaPSUIsmLsUohl25qYBpFRGML/KeHXCdhLbMic6XmCf/qKB5H3wFXzgm/eHLP0YVhomNoDkjBZd1A+fN5o8g+EQMpXOMmQYG5Dm5b2PHlDoveI/riSvO878FhSKNcU5pu447lqQEITjw7Z3lhglBWy3O2OW2Nsv2+20rF1oew57n9ffnY433NfelQOg7TaQ/ku56pNzrRZ4L5baJ6Abl3Uj8s1wjHYMXA89QOxKWt5jEhezilJvZB88tW2QRfqQLkyCQOVR1YQuLkWR3J1EArQqlykSOgtrhPcebFXu6bRO6ywg3UTRXADKrhFfMYApA7feTp2o07zCD/CqdiaWyzC+MVN0x0K2L5fvlRS2Cq3n+i+gkEObkn968iWx+9NPiSBGNixEdxxD4aKPK//ZHfUDMPF8=
  - secure: mPHBDvyZuEgE35F+Y/bqejhk2qzZRXyysuy0vqxXldL/mczqdkJcTVPKE+Bvnh1un6cHJMUgjDG1m/FDC30WEFjo6vDmw5d8GJvi45+sQpdciG0UFPYCXUNfSwsHwS1VNB2dArMLuSoVuul9HcaGE+CaP9ibm8OSIgGcODaAZ/aldvT3tz/3qxNKL6K1iUDxiN8Yi8740wmwZwJAhLVgGDd956hE/+NuKR0Na/u9BP0Awk8q4+ciBVNKkP63ssYMbKHfUIq3iCQC8PDnwV6aj7tIcgokUjthWAxcMCuee47pajJuRe3PFBWa+eIg/yvZ9DBTjki9Gc25wjAPes44gesEzoLScezGugZ5w6eWXH+lt7KIRQD8MeEPXBagnzLeHg7RAWWjl2vbiq0mwhk5/mWa3ZOmcw2gmfimhnaSGcWNujvIHbqlc1dWDpcuCRFQnYNDL8AA5YyZZf6lASJRw7eQD1MVigKH+NmEC+rMxcwo9UYa5BxDDYVpp0iOWk7vDIpAVm3akPAt6BTZ0CZ3Db+et7GjGUAkIbPTjVEdzNGFqaXZ440+zBq9PaJnEfWQuLp64lh9ny+1xT6qgpdzBZSqctoE+FgpFyO8n7vIyW5JJJK1s7qtyzu5vCj0IPOkSCJjJCezcnb7a1vKi8jQ1RKkYSM/5urkrzzkHFI3LCE=
before_install:
- pip install --user awscli
script: make
deploy:
  provider: script
  script: make release && aws s3 cp pkg/payload.zip "s3://$BUCKET/lambdas/payload-$TRAVIS_TAG.zip"
    || travis_terminate 1
  skip_cleanup: true
  on:
    tags: true
notifications:
  email: false
  slack:
    secure: WYODL/nsmTH8CZuxUVEAS9IDSYko+Biy4epV9gjxMZOJHJp03LJWJ9TIBqyfxmo1D/EtGy5QOw0S996NB51qkhvrszeBnA2lObhb2EWkVtv5To3LYTd9pt0by3tVbiA180k8LV6hNlWpqTLc/OOVH/8ts28SyubeTNzbRjXRzuKvR9f0QLamsNoQSwASgqUwNvH4Jck+MRpRvJX5IWCxBVhe6+P/ah72t1wVXO4sbDl+JhMvg8rzQaphwbbD5a3sTttIKo9AtvPnQDVjjgcKVHfkPCzasJ+9adFycML2Y1tTb+5+UW6n2/eXzU2VXrZ+04P8HBuQZFRrX/3d8q/+WaTHG4zVYSrsw93uF2BlTdKk+1oigdkeYfk+bBFS8rYCd+Tuzb5nQi0cqKbICDznoQ4xVAg6CwJa0NOSrijsTXcj6tooZh2YOytNl0AUI5OfcVJLesV66j1XH1qOgc8xQwfhkIs6OJhcBNSbmF/w1qq82mSUQB/HURNlzTJyOdHS9oeZVNhcjxLR/i0AZPdCJPugQmP1IgDIdGpBXIgbcukeK1NbhLw5aVpiVsX6WEfZVuJe7dhBYWZHR5c1QZZHMOTW76F81ypWsniWHtsdYrm/G9j4qd1UncXfcmGSJL/hX01jTUx92lv2HI3+dxNbCBmqSHE9gGbWNOrlSObECJ8=
