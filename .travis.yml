sudo: required
dist: trusty
services:
- docker
env:
  global:
  - PATH=$HOME/.local/bin:$PATH
  - PKGFORGE_STATEFILE=/tmp/pkgforge
  - BUCKET=akerl-s3-auth-proxy
  - secure: CJt9h/tzZ96/QNJvlndIzISUOARF9rmcjaOir+egUoE5nYPVEsiKXANd8fvi6tAaqcgbe4l3CcXbcxFdeguCtJxeX3IS9rNNYm7qLUgZt5IqwHM+nlCacpP1+t86lPNGgufsJGPcFlB5OY2sgvPf/6nkxdrXOIQkcK816v8KZ8qH1Op6HooGZJ+zQf1UvcrX4pyUWWgOR+sAdIaAM/vel1OpXrCaLzmi4Ou6flFh68y2TYbM6tSjpzygav1ieEkniwHPWZ5luOiodTrwmqW/bxiErh7wfjtvUex/4l9xAsti1m3NWvrS30pQqTowuJPZoesNkftWL7iAXUiBUmZCi6n+bBxecXQXZQnTSYQgjbp7ZkESNVzPCoQrCDwxKDucm2elP6x0Q/iCNnlq4miVoLo5Saojburig35WFcFeaVaQkpTFccxfSFpA1zpijxciA7USao6BKHxOYWQqieAJfdvjOgxGGDwXLVDk95vW6Qq2UIVF0YTBNUUbpsvS0rNdZrzfVjk8HHqQicX6O1pmS0L31BhvO51Pvn4HTKEgmtE+VG6xrRChHzCpPPmKPWpn8a4smCzjlxL/qGrOMTCvCdhRcV7afSt7T2RhxnSndNFIXcWWEwmHIYm0anXHseuYIzRH85N6Es9rb9okTsx98p1ovnoYdZuFCbwljlqgF5s=
  - secure: eSw/caVle5kW9qstGtm07FBcgwhmRr35/O2SufBlaNfBGETJMXYIyxzLGFO3PWiIUNGOntBLGqiL9uSHizalRNS5jbVLiR/+xwHW99mRXL/evH8OLdEp1Rca1sXmkZIEmpQ0tCnmfL3f4kBue+aeyfEs5CHP5i1qmZiglDK/bPbZIdNgKjJT9tHkPYyh4nST3qVi3sQkXzV23OnDTei4/zklL9M1ZQ7PFsrfBXujGAuWCLQ13IbZ5mRIeiXnnNmvWMiBmUNq1YKMpyKDB8A4o/Ga9ZGSZqb6i1+6vKIHJtPYwtlwE1LVfR7Uv8Olkcc8B5iFBFMudWpBhY2oRHrSQMt93wPuT9ouwxNZSJLlGe3bud1QsklSiL9sjnK3HqtiyVQP8+lrpRXsYf/DwhnGOX3FNYJWbim6SESDAyr8lXyms5ScoKIWZX4Qflpn8vzYxJXQkEwDA4FoEJhDZ2FDwtekIaTvn7hxkRu5vOOY/IzAkN+qAvnHU+49hCTgmUHvCoiYOT4mOlNo0GYFuECFRtAKp2r/QSUh4gG+kYQrvJO9oRcYpRZWFRbQhifs4w89S9sorUC+oUOJNwQdZqq7Rr+Owuxy+nUx+RaD+1hVUxzTv9JzD3uCoskBVoL1TZMM5vT7l7qYAsj+HLGGkkTlhzNdIeorYoQTVd5LAODPgUo=
  - secure: ZbYuby0G+D8e/2sK7RBu9ce8MsMrch9pdHB78q+t/1JsTAAllmlIJLpGb6fCp0zzZLRfiaCG+MMmLDvYeUBOnZAcri3OC39LXzH3dt8xW/inXOrmJuvMbx4KTjhctkzyWD8AXDZs2AlKpDTQ52CIwXTOapl8dOk14lrwYSEdzVAQSyvGLZHJxniY4IlpPFW96dZrKURqnyBa75y0UhpR/G9Iup1yHC1RWDoP8BxxjFpw3eRz/02BAwQ5QxH6B3cd79YV6bGOtwBYxicAekis4DZR5XVk5xdPCgSfFz8RRP2nS0XznoOgCsouSJ2LiMaNjV3UKixOvCwtLbI8a1CyZu4YPL1smEh8fiwfepBt3AukU7l/j3Gh2glqCTaFP/xxyJfImXdpM1MYuLPP2KNu99aOY9RLPYy3wE0b9I75WdTU0tYuPfBWcMWyLnF2zNSxVGWboCoQc54f9kG+6aDwzcYQtlhhxArx2BUaqGt9CJhkNOM1qGwhaoIVVfqxvJ+q5jjMhf0sZJNF9metRbSPA2+pnWRxL9k27/A2GimV9tU5erEDQIeZaxRdrdRX2VEu3LF31wCGIUtDs4hYq9u3t+HOMsu8tFbn/WYg8qBoSePDDZTXzZuGCPP5i7JwuVbn9G86JG1ZsX+G2PGQV1tzyNfTk+wz2ItNQ5k1hTsCR8s=
before_install:
- pip install --user awscli
script: make
deploy:
  provider: script
  script: make release && aws s3 cp pkg/payload.zip "s3://$BUCKET/lambdas/payload-$TRAVIS_TAG.zip"
    || travis_terminate 1
  skip_cleanup: true
  on:
    tags: true
notifications:
  email: false
  slack:
    secure: WYODL/nsmTH8CZuxUVEAS9IDSYko+Biy4epV9gjxMZOJHJp03LJWJ9TIBqyfxmo1D/EtGy5QOw0S996NB51qkhvrszeBnA2lObhb2EWkVtv5To3LYTd9pt0by3tVbiA180k8LV6hNlWpqTLc/OOVH/8ts28SyubeTNzbRjXRzuKvR9f0QLamsNoQSwASgqUwNvH4Jck+MRpRvJX5IWCxBVhe6+P/ah72t1wVXO4sbDl+JhMvg8rzQaphwbbD5a3sTttIKo9AtvPnQDVjjgcKVHfkPCzasJ+9adFycML2Y1tTb+5+UW6n2/eXzU2VXrZ+04P8HBuQZFRrX/3d8q/+WaTHG4zVYSrsw93uF2BlTdKk+1oigdkeYfk+bBFS8rYCd+Tuzb5nQi0cqKbICDznoQ4xVAg6CwJa0NOSrijsTXcj6tooZh2YOytNl0AUI5OfcVJLesV66j1XH1qOgc8xQwfhkIs6OJhcBNSbmF/w1qq82mSUQB/HURNlzTJyOdHS9oeZVNhcjxLR/i0AZPdCJPugQmP1IgDIdGpBXIgbcukeK1NbhLw5aVpiVsX6WEfZVuJe7dhBYWZHR5c1QZZHMOTW76F81ypWsniWHtsdYrm/G9j4qd1UncXfcmGSJL/hX01jTUx92lv2HI3+dxNbCBmqSHE9gGbWNOrlSObECJ8=
